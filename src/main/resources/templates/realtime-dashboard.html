<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ - Search Insights</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #1a73e8;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    .dashboard-box {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .dashboard-title {
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    th {
      background-color: #f2f2f2;
    }
    .active-users {
      font-size: 24px;
      color: #1a73e8;
      font-weight: bold;
    }
    .update-time {
      font-size: 12px;
      color: #666;
      text-align: right;
    }
    .progress-bar {
      background-color: #e0e0e0;
      height: 8px;
      border-radius: 4px;
      margin-right: 10px;
    }
    .progress-value {
      background-color: #1a73e8;
      height: 8px;
      border-radius: 4px;
    }

    /* ë©”ì¸ íƒ­ ìŠ¤íƒ€ì¼ë§ */
    .main-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #ddd;
    }
    .main-tab {
      padding: 10px 20px;
      cursor: pointer;
      border: 1px solid #ddd;
      border-bottom: none;
      border-radius: 8px 8px 0 0;
      background-color: #f8f8f8;
      margin-right: 5px;
      transition: all 0.3s ease;
    }
    .main-tab:hover {
      background-color: #e6f7ff;
    }
    .main-tab.active {
      background-color: #1a73e8;
      color: white;
      font-weight: bold;
      transform: translateY(-3px);
      box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
    }

    /* ì„œë¸Œ íƒ­ ìŠ¤íƒ€ì¼ë§ */
    .sub-tabs {
      display: flex;
      margin-bottom: 15px;
      margin-top: 10px;
    }
    .sub-tab {
      padding: 8px 15px;
      cursor: pointer;
      border: 1px solid #ddd;
      border-radius: 20px;
      background-color: #f8f8f8;
      margin-right: 8px;
      font-size: 0.9em;
      transition: all 0.2s ease;
    }
    .sub-tab:hover {
      background-color: #e6f7ff;
    }
    .sub-tab.active {
      background-color: #4285f4;
      color: white;
      font-weight: bold;
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.5s;
    }
    .tab-content.active {
      display: block;
    }

    .sub-tab-content {
      display: none;
      animation: fadeIn 0.5s;
    }
    .sub-tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* ê·€ì—¬ìš´ ì•„ì´ì½˜ë“¤ */
    .heart-icon {
      color: #ff4081;
      margin-right: 5px;
    }

    .date-selector {
      display: flex;
      align-items: center;
      margin: 15px 0;
      gap: 10px;
    }

    .date-selector input[type="date"] {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .fetch-btn {
      padding: 8px 15px;
      background-color: #1a73e8;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .fetch-btn:hover {
      background-color: #1558b3;
      transform: translateY(-2px);
    }

    .auto-update-check {
      margin-left: 15px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .category-icon {
      color: #9C27B0;
      margin-right: 5px;
    }

    /* ë™ê¸°í™” ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .sync-button {
      background-color: #9C27B0;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 1em;
      font-weight: bold;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      margin-left: auto;
      box-shadow: 0 3px 5px rgba(156, 39, 176, 0.3);
    }

    .sync-button:hover {
      background-color: #7B1FA2;
      transform: translateY(-2px);
      box-shadow: 0 5px 8px rgba(156, 39, 176, 0.5);
    }

    /* ë™ê¸°í™” ìƒíƒœ ì•Œë¦¼ ë°°ë„ˆ */
    .sync-banner {
      background-color: #E1BEE7;
      color: #4A148C;
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
      display: none;
      align-items: center;
      text-align: center;
      font-weight: bold;
    }

    .sync-banner.visible {
      display: flex;
      justify-content: center;
    }

    .sync-button-icon {
      margin-right: 5px;
    }

    .full-sync-button {
      background-color: #FF5722;
      margin-left: 10px;
    }

    .full-sync-button:hover {
      background-color: #E64A19;
    }

  </style>
</head>
<body>
<div class="container">
  <h1>ğŸ˜ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</h1>

  <!-- ë©”ì¸ íƒ­ -->
  <div class="main-tabs">
    <div class="main-tab active" onclick="showMainTab('today')">ğŸŒ ì˜¤ëŠ˜ ì „ì²´</div>
    <div class="main-tab" onclick="showMainTab('last30min')">âš¡ ìµœê·¼ 30ë¶„</div>
    <div class="main-tab" onclick="showMainTab('custom-date')">ğŸ“† ë‚ ì§œ ì§€ì •</div>
  </div>

  <!-- ì˜¤ëŠ˜ ì „ì²´ íƒ­ ì»¨í…ì¸  -->
  <div id="today-content" class="tab-content active">
    <div class="dashboard-box">
      <div style="display: flex; justify-content: space-between;">
        <!-- ì™¼ìª½ êµ¬ì—­ (ë¹¨ê°„ìƒ‰ ë¶€ë¶„) -->
        <div style="width: 18%;">
          <div class="dashboard-title">ğŸ” ì˜¤ëŠ˜ ì „ì²´ í™œì„± ì‚¬ìš©ì</div>
          <div class="active-users" id="today-active-users">0</div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ êµ¬ì—­ (ì£¼í™©ìƒ‰ ë¶€ë¶„) -->
        <div style="width: 78%;">
          <div class="dashboard-title" style="margin-top: 0;">ğŸ”¢ ì˜¤ëŠ˜ ì „ì²´ ì¡°íšŒìˆ˜</div>
          <div class="active-users" id="today-total-pageviews">0</div>
        </div>
      </div>

      <div class="update-time" id="today-update-time">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: -</div>
    </div>

    <!-- ì„œë¸Œ íƒ­ (ì˜¤ëŠ˜ ì „ì²´) -->
    <div class="sub-tabs">
      <div class="sub-tab active" onclick="showSubTab('today', 'full')">ğŸ“Š ì „ì²´ ì œëª©</div>
      <div class="sub-tab" onclick="showSubTab('today', 'prefix1')">1ï¸âƒ£ ì ‘ë‘ì–´ (1ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('today', 'prefix2')">2ï¸âƒ£ ì ‘ë‘ì–´ (2ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('today', 'prefix3')">3ï¸âƒ£ ì ‘ë‘ì–´ (3ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('today', 'category')">ğŸ“‘ ì¹´í…Œê³ ë¦¬ë³„</div>
      <button class="sync-button" onclick="syncWordPressCategories(false)">
        <span class="sync-button-icon">ğŸ”„</span> ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ë™ê¸°í™”
      </button>
      <button class="sync-button full-sync-button" onclick="syncWordPressCategories(true)">
        <span class="sync-button-icon">ğŸ”</span> ì¹´í…Œê³ ë¦¬ ì „ì²´ ì´ˆê¸°í™”
      </button>
    </div>

    <!-- ì „ì²´ ì œëª© í…Œì´ë¸” (ì˜¤ëŠ˜) -->
    <div id="today-full-content" class="sub-tab-content active">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ“ˆ í˜ì´ì§€ ì œëª©ë³„ ì¡°íšŒìˆ˜ (ì˜¤ëŠ˜)</div>
        <table>
          <thead>
          <tr>
            <th>í˜ì´ì§€ ì œëª©</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="today-page-title-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 1ë‹¨ì–´ í…Œì´ë¸” (ì˜¤ëŠ˜) -->
    <div id="today-prefix1-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (1ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="today-prefix1-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 2ë‹¨ì–´ í…Œì´ë¸” (ì˜¤ëŠ˜) -->
    <div id="today-prefix2-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (2ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="today-prefix2-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 3ë‹¨ì–´ í…Œì´ë¸” (ì˜¤ëŠ˜) -->
    <div id="today-prefix3-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (3ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="today-prefix3-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <div id="today-category-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div id="sync-banner-today" class="sync-banner">ğŸ”„ ì•„ì§ ë™ê¸°í™”ëœ ì¹´í…Œê³ ë¦¬ ë°ì´í„°ê°€ ì—†ì–´ìš”! ë™ê¸°í™” ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!</div>
        <div class="dashboard-title">ğŸ“‘ ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒìˆ˜ (ì˜¤ëŠ˜)</div>
        <table>
          <thead>
          <tr>
            <th>ì¹´í…Œê³ ë¦¬</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="today-category-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

  </div>


  <!-- ìµœê·¼ 30ë¶„ íƒ­ ì»¨í…ì¸  -->
  <div id="last30min-content" class="tab-content">
    <div class="dashboard-box">
      <div style="display: flex; justify-content: space-between;">
        <!-- ì™¼ìª½ êµ¬ì—­ -->
        <div style="width: 18%;">
          <div class="dashboard-title">ğŸ”¥ ìµœê·¼ 30ë¶„ í™œì„± ì‚¬ìš©ì</div>
          <div class="active-users" id="last30min-active-users">0</div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ êµ¬ì—­ -->
        <div style="width: 78%;">
          <div class="dashboard-title" style="margin-top: 0;">ğŸ”¢ ìµœê·¼ 30ë¶„ ì „ì²´ ì¡°íšŒìˆ˜</div>
          <div class="active-users" id="last30min-total-pageviews">0</div>
        </div>
      </div>

      <div class="update-time" id="last30min-update-time">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: -</div>
    </div>

    <!-- ì„œë¸Œ íƒ­ (ìµœê·¼ 30ë¶„) -->
    <div class="sub-tabs">
      <div class="sub-tab active" onclick="showSubTab('last30min', 'full')">ğŸ“Š ì „ì²´ ì œëª©</div>
      <div class="sub-tab" onclick="showSubTab('last30min', 'prefix1')">1ï¸âƒ£ ì ‘ë‘ì–´ (1ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('last30min', 'prefix2')">2ï¸âƒ£ ì ‘ë‘ì–´ (2ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('last30min', 'prefix3')">3ï¸âƒ£ ì ‘ë‘ì–´ (3ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('last30min', 'category')">ğŸ“‘ ì¹´í…Œê³ ë¦¬ë³„</div>
    </div>

    <!-- ì „ì²´ ì œëª© í…Œì´ë¸” (ìµœê·¼ 30ë¶„) -->
    <div id="last30min-full-content" class="sub-tab-content active">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ“ˆ í˜ì´ì§€ ì œëª©ë³„ ì¡°íšŒìˆ˜ (ìµœê·¼ 30ë¶„)</div>
        <table>
          <thead>
          <tr>
            <th>í˜ì´ì§€ ì œëª©</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="last30min-page-title-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 1ë‹¨ì–´ í…Œì´ë¸” (ìµœê·¼ 30ë¶„) -->
    <div id="last30min-prefix1-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (1ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="last30min-prefix1-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 2ë‹¨ì–´ í…Œì´ë¸” (ìµœê·¼ 30ë¶„) -->
    <div id="last30min-prefix2-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (2ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="last30min-prefix2-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 3ë‹¨ì–´ í…Œì´ë¸” (ìµœê·¼ 30ë¶„) -->
    <div id="last30min-prefix3-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (3ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="last30min-prefix3-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <div id="last30min-category-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div id="sync-banner-last30min" class="sync-banner">ğŸ”„ ì•„ì§ ë™ê¸°í™”ëœ ì¹´í…Œê³ ë¦¬ ë°ì´í„°ê°€ ì—†ì–´ìš”! ë™ê¸°í™” ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!</div>
        <div class="dashboard-title">ğŸ“‘ ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒìˆ˜ (ìµœê·¼ 30ë¶„)</div>
        <table>
          <thead>
          <tr>
            <th>ì¹´í…Œê³ ë¦¬</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="last30min-category-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ë‚ ì§œ ì§€ì • íƒ­ ì»¨í…ì¸  -->
  <div id="custom-date-content" class="tab-content">
    <div class="dashboard-box">
      <div class="date-selector">
        <input type="date" id="start-date" onchange="validateDates()">
        <span>~</span>
        <input type="date" id="end-date" onchange="validateDates()">
        <button onclick="fetchCustomDateData()" class="fetch-btn">ğŸ” ì¡°íšŒí•˜ê¸°</button>
        <div class="auto-update-check">
          <input type="checkbox" id="auto-update-check">
          <label for="auto-update-check">ì˜¤ëŠ˜ í¬í•¨ì‹œ ìë™ ì—…ë°ì´íŠ¸</label>
        </div>
      </div>

      <div style="display: flex; justify-content: space-between; margin-top: 15px;">
        <!-- ì™¼ìª½ êµ¬ì—­ -->
        <div style="width: 18%;">
          <div class="dashboard-title">ğŸ“… ì§€ì • ê¸°ê°„ í™œì„± ì‚¬ìš©ì</div>
          <div class="active-users" id="custom-date-active-users">0</div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ êµ¬ì—­ -->
        <div style="width: 78%;">
          <div class="dashboard-title" style="margin-top: 0;">ğŸ”¢ ì§€ì • ê¸°ê°„ ì „ì²´ ì¡°íšŒìˆ˜</div>
          <div class="active-users" id="custom-date-total-pageviews">0</div>
        </div>
      </div>

      <div class="update-time" id="custom-date-update-time">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: -</div>
    </div>

    <!-- ì„œë¸Œ íƒ­ (ë‚ ì§œ ì§€ì •) -->
    <div class="sub-tabs">
      <div class="sub-tab active" onclick="showSubTab('custom-date', 'full')">ğŸ“Š ì „ì²´ ì œëª©</div>
      <div class="sub-tab" onclick="showSubTab('custom-date', 'prefix1')">1ï¸âƒ£ ì ‘ë‘ì–´ (1ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('custom-date', 'prefix2')">2ï¸âƒ£ ì ‘ë‘ì–´ (2ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('custom-date', 'prefix3')">3ï¸âƒ£ ì ‘ë‘ì–´ (3ë‹¨ì–´)</div>
      <div class="sub-tab" onclick="showSubTab('custom-date', 'category')">ğŸ“‘ ì¹´í…Œê³ ë¦¬ë³„</div>
    </div>

    <!-- ì „ì²´ ì œëª© í…Œì´ë¸” (ë‚ ì§œ ì§€ì •) -->
    <div id="custom-date-full-content" class="sub-tab-content active">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ“ˆ í˜ì´ì§€ ì œëª©ë³„ ì¡°íšŒìˆ˜ (ì§€ì • ê¸°ê°„)</div>
        <table>
          <thead>
          <tr>
            <th>í˜ì´ì§€ ì œëª©</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="custom-date-page-title-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 1ë‹¨ì–´ í…Œì´ë¸” (ë‚ ì§œ ì§€ì •) -->
    <div id="custom-date-prefix1-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (1ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="custom-date-prefix1-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 2ë‹¨ì–´ í…Œì´ë¸” (ë‚ ì§œ ì§€ì •) -->
    <div id="custom-date-prefix2-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (2ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="custom-date-prefix2-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì ‘ë‘ì–´ 3ë‹¨ì–´ í…Œì´ë¸” (ë‚ ì§œ ì§€ì •) -->
    <div id="custom-date-prefix3-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div class="dashboard-title">ğŸ”¤ ì ‘ë‘ì–´ë³„ ì¡°íšŒìˆ˜ (3ë‹¨ì–´)</div>
        <table>
          <thead>
          <tr>
            <th>ì ‘ë‘ì–´</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="custom-date-prefix3-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì¹´í…Œê³ ë¦¬ë³„ í…Œì´ë¸” (ë‚ ì§œ ì§€ì •) ì¶”ê°€ -->
    <div id="custom-date-category-content" class="sub-tab-content">
      <div class="dashboard-box">
        <div id="sync-banner-custom-date" class="sync-banner">ğŸ”„ ì•„ì§ ë™ê¸°í™”ëœ ì¹´í…Œê³ ë¦¬ ë°ì´í„°ê°€ ì—†ì–´ìš”! ë™ê¸°í™” ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!</div>
        <div class="dashboard-title">ğŸ“‘ ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒìˆ˜ (ì§€ì • ê¸°ê°„)</div>
        <table>
          <thead>
          <tr>
            <th>ì¹´í…Œê³ ë¦¬</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë¹„ìœ¨</th>
          </tr>
          </thead>
          <tbody id="custom-date-category-views">
          <!-- ì—¬ê¸°ì— ë°ì´í„°ê°€ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
  // í˜ì´ì§€ ë¡œë“œì‹œ ì²˜ìŒ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  document.addEventListener('DOMContentLoaded', function() {
    fetchTodayData();
    fetchLast30MinData();

    // 10ì´ˆë§ˆë‹¤ ë°ì´í„° ê°±ì‹ 
    setInterval(fetchTodayData, 10000);
    setInterval(fetchLast30MinData, 10000);

    // ë‚ ì§œ ì„ íƒê¸° ì´ˆê¸°í™” - ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì„¤ì •
    const now = new Date();
    const today = now.getFullYear() + '-' +
        String(now.getMonth() + 1).padStart(2, '0') + '-' +
        String(now.getDate()).padStart(2, '0');

    document.getElementById('start-date').value = today;
    document.getElementById('end-date').value = today;

    document.getElementById('auto-update-check').addEventListener('change', function() {
      if (this.checked && document.getElementById('end-date').value === today) {
        fetchCustomDateData();
      }
    });

    // ë™ê¸°í™” ìƒíƒœ í™•ì¸
    checkSyncStatus();
  });

  // ë™ê¸°í™” ìƒíƒœ í™•ì¸ í•¨ìˆ˜
  function checkSyncStatus() {
    fetch('/api/realtime-pageviews')
    .then(response => response.json())
    .then(data => {
      const hasCategories = data.categoryViews && Object.keys(data.categoryViews).length > 0;

      // ê° íƒ­ì˜ ë°°ë„ˆ í‘œì‹œ/ìˆ¨ê¹€ ì„¤ì •
      document.getElementById('sync-banner-today').classList.toggle('visible', !hasCategories);
      document.getElementById('sync-banner-last30min').classList.toggle('visible', !hasCategories);
      document.getElementById('sync-banner-custom-date').classList.toggle('visible', !hasCategories);
    })
    .catch(error => console.error('ë™ê¸°í™” ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error));
  }

  // ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒìˆ˜ í…Œì´ë¸” ì—…ë°ì´íŠ¸
  function updateCategoryViewsTable(categoryViews, tableId) {
    const tableBody = document.getElementById(tableId);
    tableBody.innerHTML = '';

    // ë™ê¸°í™” ë°°ë„ˆ í‘œì‹œ ì—¬ë¶€ ì„¤ì •
    const mainTab = tableId.split('-')[0]; // "today", "last30min" ë˜ëŠ” "custom-date" ì¶”ì¶œ
    const bannerId = "sync-banner-" + mainTab;
    const syncBanner = document.getElementById(bannerId);

    if (!categoryViews || Object.keys(categoryViews).length === 0) {
      if (syncBanner) {
        syncBanner.classList.add('visible');
      } else {
        console.warn(`ì°¾ì„ ìˆ˜ ì—†ëŠ” ë°°ë„ˆì•¼! ID: "${bannerId}"`);
      }

      const row = document.createElement('tr');
      const cell = document.createElement('td');
      cell.setAttribute('colspan', '3');
      cell.textContent = 'ë°ì´í„°ê°€ ì—†ê±°ë‚˜ ì•„ì§ ì¹´í…Œê³ ë¦¬ê°€ ë™ê¸°í™”ë˜ì§€ ì•Šì•˜ì–´ìš”! ğŸ¥º';
      cell.style.textAlign = 'center';
      row.appendChild(cell);
      tableBody.appendChild(row);
      return;
    }

    // ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë°°ë„ˆ ìˆ¨ê¸°ê¸°
    if (syncBanner) {
      syncBanner.classList.remove('visible');
    }

    // ì´ ì¡°íšŒìˆ˜ ê³„ì‚°
    const totalViews = Object.values(categoryViews).reduce((sum, views) => sum + views, 0);

    // ë°°ì—´ë¡œ ë³€í™˜í•˜ì—¬ ì •ë ¬ (ì¡°íšŒìˆ˜ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ)
    const sortedCategories = Object.entries(categoryViews)
    .sort((a, b) => b[1] - a[1]);

    // í…Œì´ë¸”ì— ë°ì´í„° ì¶”ê°€
    sortedCategories.forEach(([category, views]) => {
      const row = document.createElement('tr');

      // ì¹´í…Œê³ ë¦¬ ì…€
      const categoryCell = document.createElement('td');
      categoryCell.textContent = category;
      row.appendChild(categoryCell);

      // ì¡°íšŒìˆ˜ ì…€
      const viewsCell = document.createElement('td');
      viewsCell.textContent = Math.round(views);
      row.appendChild(viewsCell);

      // ë¹„ìœ¨ ì…€ (í”„ë¡œê·¸ë ˆìŠ¤ ë°”)
      const ratioCell = document.createElement('td');
      const percentage = totalViews > 0 ? (views / totalViews * 100) : 0;

      const progressContainer = document.createElement('div');
      progressContainer.style.display = 'flex';
      progressContainer.style.alignItems = 'center';

      const progressBar = document.createElement('div');
      progressBar.className = 'progress-bar';
      progressBar.style.width = '100px';

      const progressValue = document.createElement('div');
      progressValue.className = 'progress-value';
      progressValue.style.width = `${percentage}%`;
      progressValue.style.backgroundColor = '#9C27B0'; // ì¹´í…Œê³ ë¦¬ëŠ” ë³´ë¼ìƒ‰ìœ¼ë¡œ êµ¬ë¶„

      const percentText = document.createElement('span');
      percentText.textContent = `${percentage.toFixed(1)}%`;

      progressBar.appendChild(progressValue);
      progressContainer.appendChild(progressBar);
      progressContainer.appendChild(percentText);
      ratioCell.appendChild(progressContainer);

      row.appendChild(ratioCell);
      tableBody.appendChild(row);
    });
  }

  // ë©”ì¸ íƒ­ ì „í™˜ í•¨ìˆ˜
  function showMainTab(tabName) {
    // ëª¨ë“  ë©”ì¸ íƒ­ê³¼ íƒ­ ì»¨í…ì¸ ë¥¼ ë¹„í™œì„±í™”
    document.querySelectorAll('.main-tab').forEach(tab => {
      tab.classList.remove('active');
    });
    document.querySelectorAll('.tab-content').forEach(content => {
      content.classList.remove('active');
    });

    // ì„ íƒí•œ ë©”ì¸ íƒ­ê³¼ í•´ë‹¹ ì»¨í…ì¸ ë¥¼ í™œì„±í™”
    if (tabName === 'today') {
      document.querySelector('.main-tab:nth-child(1)').classList.add('active');
      document.getElementById('today-content').classList.add('active');
    } else if (tabName === 'last30min') {
      document.querySelector('.main-tab:nth-child(2)').classList.add('active');
      document.getElementById('last30min-content').classList.add('active');
    } else if (tabName === 'custom-date') {
      document.querySelector('.main-tab:nth-child(3)').classList.add('active');
      document.getElementById('custom-date-content').classList.add('active');
    }
  }

  // ì„œë¸Œ íƒ­ ì „í™˜ í•¨ìˆ˜
  function showSubTab(mainTab, subTab) {
    // í•´ë‹¹ ë©”ì¸ íƒ­ ë‚´ì˜ ëª¨ë“  ì„œë¸Œ íƒ­ê³¼ ì„œë¸Œ íƒ­ ì»¨í…ì¸ ë¥¼ ë¹„í™œì„±í™”
    const subTabs = document.querySelectorAll(`#${mainTab}-content .sub-tab`);
    const subContents = document.querySelectorAll(`#${mainTab}-content .sub-tab-content`);

    subTabs.forEach(tab => {
      tab.classList.remove('active');
    });
    subContents.forEach(content => {
      content.classList.remove('active');
    });

    // ì„ íƒí•œ ì„œë¸Œ íƒ­ í™œì„±í™” (indexOfë¡œ ì°¾ê¸°)
    const tabTypes = ['full', 'prefix1', 'prefix2', 'prefix3', 'category'];
    const tabIndex = tabTypes.indexOf(subTab);
    if (tabIndex >= 0) {
      subTabs[tabIndex].classList.add('active');
      document.getElementById(`${mainTab}-${subTab}-content`).classList.add('active');
    }
  }

  function fetchTodayData() {
    fetch('/api/realtime-pageviews')
    .then(response => response.json())
    .then(data => {
      // í™œì„± ì‚¬ìš©ì ë° ì „ì²´ í˜ì´ì§€ë·° ì—…ë°ì´íŠ¸
      document.getElementById('today-active-users').textContent = data.activeUsers;

      // ì „ì²´ ì¡°íšŒìˆ˜ ê³„ì‚° ë° í‘œì‹œ
      const totalPageViews = data.pageViews.reduce((sum, item) => sum + item.pageViews, 0);
      document.getElementById('today-total-pageviews').textContent = Math.round(totalPageViews);

      updateTime('today-update-time');

      // ì „ì²´ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updatePageViewsTable(data.pageViews, 'today-page-title-views');

      // ì ‘ë‘ì–´ë³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updatePrefixViewsTable(data.pageViews, 'today-prefix1-views', 1);
      updatePrefixViewsTable(data.pageViews, 'today-prefix2-views', 2);
      updatePrefixViewsTable(data.pageViews, 'today-prefix3-views', 3);

      // ì¹´í…Œê³ ë¦¬ë³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updateCategoryViewsTable(data.categoryViews, 'today-category-views');
    })
    .catch(error => console.error('ì˜¤ëŠ˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error));
  }

  function fetchLast30MinData() {
    fetch('/api/last30min-pageviews')
    .then(response => response.json())
    .then(data => {
      // í™œì„± ì‚¬ìš©ì ë° ì „ì²´ í˜ì´ì§€ë·° ì—…ë°ì´íŠ¸
      document.getElementById('last30min-active-users').textContent = data.activeUsers;

      // ì „ì²´ ì¡°íšŒìˆ˜ ê³„ì‚° ë° í‘œì‹œ
      const totalPageViews = data.pageViews.reduce((sum, item) => sum + item.pageViews, 0);
      document.getElementById('last30min-total-pageviews').textContent = Math.round(totalPageViews);

      updateTime('last30min-update-time');

      // ì „ì²´ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updatePageViewsTable(data.pageViews, 'last30min-page-title-views');

      // ì ‘ë‘ì–´ë³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updatePrefixViewsTable(data.pageViews, 'last30min-prefix1-views', 1);
      updatePrefixViewsTable(data.pageViews, 'last30min-prefix2-views', 2);
      updatePrefixViewsTable(data.pageViews, 'last30min-prefix3-views', 3);

      // ì¹´í…Œê³ ë¦¬ë³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updateCategoryViewsTable(data.categoryViews, 'last30min-category-views');
    })
    .catch(error => console.error('ìµœê·¼ 30ë¶„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error));
  }

  // ì „ì²´ í˜ì´ì§€ ì œëª©ë³„ ì¡°íšŒìˆ˜ í…Œì´ë¸” ì—…ë°ì´íŠ¸
  function updatePageViewsTable(data, tableId) {
    const tableBody = document.getElementById(tableId);
    tableBody.innerHTML = '';

    // ì´ ì¡°íšŒìˆ˜ ê³„ì‚°
    const totalViews = data.reduce((sum, item) => sum + item.pageViews, 0);

    // ë°ì´í„° ì •ë ¬ (ì¡°íšŒìˆ˜ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ)
    data.sort((a, b) => b.pageViews - a.pageViews);

    // í…Œì´ë¸”ì— ë°ì´í„° ì¶”ê°€
    data.forEach(item => {
      const row = document.createElement('tr');

      // í˜ì´ì§€ ì œëª© ì…€
      const titleCell = document.createElement('td');
      titleCell.textContent = item.pageTitle || '(ì œëª© ì—†ìŒ)';
      row.appendChild(titleCell);

      // ì¡°íšŒìˆ˜ ì…€
      const viewsCell = document.createElement('td');
      viewsCell.textContent = Math.round(item.pageViews);
      row.appendChild(viewsCell);

      // ë¹„ìœ¨ ì…€ (í”„ë¡œê·¸ë ˆìŠ¤ ë°”)
      const ratioCell = document.createElement('td');
      const percentage = totalViews > 0 ? (item.pageViews / totalViews * 100) : 0;

      const progressContainer = document.createElement('div');
      progressContainer.style.display = 'flex';
      progressContainer.style.alignItems = 'center';

      const progressBar = document.createElement('div');
      progressBar.className = 'progress-bar';
      progressBar.style.width = '100px';

      const progressValue = document.createElement('div');
      progressValue.className = 'progress-value';
      progressValue.style.width = `${percentage}%`;

      const percentText = document.createElement('span');
      percentText.textContent = `${percentage.toFixed(1)}%`;

      progressBar.appendChild(progressValue);
      progressContainer.appendChild(progressBar);
      progressContainer.appendChild(percentText);
      ratioCell.appendChild(progressContainer);

      row.appendChild(ratioCell);
      tableBody.appendChild(row);
    });
  }

  // ì ‘ë‘ì–´(Prefix)ë³„ ì¡°íšŒìˆ˜ í…Œì´ë¸” ì—…ë°ì´íŠ¸
  function updatePrefixViewsTable(data, tableId, wordCount) {
    const tableBody = document.getElementById(tableId);
    tableBody.innerHTML = '';

    // í˜ì´ì§€ ì œëª©ì„ ì ‘ë‘ì–´ë¡œ ê·¸ë£¹í™”
    const prefixGroups = groupByPrefix(data, wordCount);

    // ì´ ì¡°íšŒìˆ˜ ê³„ì‚°
    const totalViews = data.reduce((sum, item) => sum + item.pageViews, 0);

    // ì •ë ¬ëœ ì ‘ë‘ì–´ ë°°ì—´ (ì¡°íšŒìˆ˜ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ)
    const sortedPrefixes = Object.keys(prefixGroups).sort((a, b) => {
      const sumA = prefixGroups[a].reduce((sum, item) => sum + item.pageViews, 0);
      const sumB = prefixGroups[b].reduce((sum, item) => sum + item.pageViews, 0);
      return sumB - sumA;
    });

    // í…Œì´ë¸”ì— ë°ì´í„° ì¶”ê°€
    sortedPrefixes.forEach(prefix => {
      const items = prefixGroups[prefix];
      const prefixTotalViews = items.reduce((sum, item) => sum + item.pageViews, 0);

      const row = document.createElement('tr');

      // ì ‘ë‘ì–´ ì…€
      const prefixCell = document.createElement('td');
      prefixCell.textContent = prefix;
      row.appendChild(prefixCell);

      // ì¡°íšŒìˆ˜ ì…€
      const viewsCell = document.createElement('td');
      viewsCell.textContent = Math.round(prefixTotalViews);
      row.appendChild(viewsCell);

      // ë¹„ìœ¨ ì…€ (í”„ë¡œê·¸ë ˆìŠ¤ ë°”)
      const ratioCell = document.createElement('td');
      const percentage = totalViews > 0 ? (prefixTotalViews / totalViews * 100) : 0;

      const progressContainer = document.createElement('div');
      progressContainer.style.display = 'flex';
      progressContainer.style.alignItems = 'center';

      const progressBar = document.createElement('div');
      progressBar.className = 'progress-bar';
      progressBar.style.width = '100px';

      const progressValue = document.createElement('div');
      progressValue.className = 'progress-value';
      progressValue.style.width = `${percentage}%`;

      const percentText = document.createElement('span');
      percentText.textContent = `${percentage.toFixed(1)}%`;

      progressBar.appendChild(progressValue);
      progressContainer.appendChild(progressBar);
      progressContainer.appendChild(percentText);
      ratioCell.appendChild(progressContainer);

      row.appendChild(ratioCell);
      tableBody.appendChild(row);
    });
  }

  // í˜ì´ì§€ ì œëª©ì„ ì ‘ë‘ì–´ë¡œ ê·¸ë£¹í™”í•˜ëŠ” í•¨ìˆ˜
  function groupByPrefix(data, wordCount) {
    const groups = {};

    data.forEach(item => {
      const title = (item.pageTitle || '(ì œëª© ì—†ìŒ)').toLowerCase();
      const words = title.split(' ');

      let prefix;
      if (wordCount === 1) {
        prefix = words.length > 0 ? words[0] : '';
      } else if (words.length >= wordCount) {
        prefix = words.slice(0, wordCount).join(' ');
      } else {
        prefix = title; // ë‹¨ì–´ ìˆ˜ê°€ ë¶€ì¡±í•œ ê²½ìš° ì „ì²´ ì œëª©ì„ ì‚¬ìš©
      }

      if (prefix) {
        if (!groups[prefix]) {
          groups[prefix] = [];
        }
        groups[prefix].push(item);
      }
    });

    return groups;
  }

  function updateTime(elementId) {
    const now = new Date();
    const timeString = now.toLocaleTimeString();
    document.getElementById(elementId).textContent = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${timeString}`;
  }

  // ë‚ ì§œ ìœ íš¨ì„± ê²€ì‚¬
  function validateDates() {
    const startDate = document.getElementById('start-date').value;
    const endDate = document.getElementById('end-date').value;

    if (startDate && endDate && new Date(startDate) > new Date(endDate)) {
      alert('ğŸš¨ ì‹œì‘ì¼ì´ ì¢…ë£Œì¼ë³´ë‹¤ ëŠ¦ì„ ìˆ˜ ì—†ì–´ìš”!');
      document.getElementById('end-date').value = startDate;
    }
  }

  // ë‚ ì§œ ì§€ì • ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  function fetchCustomDateData() {
    const startDate = document.getElementById('start-date').value;
    const endDate = document.getElementById('end-date').value;

    if (!startDate || !endDate) {
      alert('â“ ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”!');
      return;
    }

    // API ìš”ì²­
    fetch(`/api/custom-date-pageviews?startDate=${startDate}&endDate=${endDate}`)
    .then(response => response.json())
    .then(data => {
      // í™œì„± ì‚¬ìš©ì ì—…ë°ì´íŠ¸
      document.getElementById('custom-date-active-users').textContent = data.activeUsers;

      // ì „ì²´ ì¡°íšŒìˆ˜ ê³„ì‚° ë° í‘œì‹œ
      const totalPageViews = data.pageViews.reduce((sum, item) => sum + item.pageViews, 0);
      document.getElementById('custom-date-total-pageviews').textContent = Math.round(totalPageViews);

      updateTime('custom-date-update-time');

      // í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updatePageViewsTable(data.pageViews, 'custom-date-page-title-views');
      updatePrefixViewsTable(data.pageViews, 'custom-date-prefix1-views', 1);
      updatePrefixViewsTable(data.pageViews, 'custom-date-prefix2-views', 2);
      updatePrefixViewsTable(data.pageViews, 'custom-date-prefix3-views', 3);

      // ì¹´í…Œê³ ë¦¬ë³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì¶”ê°€
      updateCategoryViewsTable(data.categoryViews, 'custom-date-category-views');
    })
    .catch(error => console.error('ë‚ ì§œ ì§€ì • ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error));
  }

  // ìë™ ì—…ë°ì´íŠ¸ ì„¤ì •
  let customDateInterval;
  function setupAutoUpdate() {

    console.log('setupAutoUpdate í˜¸ì¶œë¨(ì‚¬ìš© ì•ˆí•¨)');
    // ê¸°ì¡´ ì¸í„°ë²Œ ì œê±°
    if (customDateInterval) {
      clearInterval(customDateInterval);
    }

    // ì˜¤ëŠ˜ ë‚ ì§œ í¬í•¨ í™•ì¸ ë° ìë™ ì—…ë°ì´íŠ¸ ì²´í¬ë°•ìŠ¤ í™•ì¸
    const endDate = document.getElementById('end-date').value;
    const autoUpdate = document.getElementById('auto-update-check').checked;
    const today = new Date().toISOString().split('T')[0]; // ì˜¤ëŠ˜ ë‚ ì§œ YYYY-MM-DD í˜•ì‹

    if (endDate === today && autoUpdate) {
      // 10ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
      customDateInterval = setInterval(fetchCustomDateData, 10000);
    }
  }

  document.getElementById('auto-update-check').addEventListener('change', function() {
    console.log('ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë³€ê²½: ', this.checked);

    // ì´ì „ íƒ€ì´ë¨¸ ì´ˆê¸°í™”
    if (customDateInterval) {
      clearInterval(customDateInterval);
      customDateInterval = null;
    }

    if (this.checked) {
      // ì²´í¬í–ˆì„ ë•Œ ì¼ë‹¨ ë°”ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      fetchCustomDateData();

      // í˜„ì¬ ì‹œìŠ¤í…œ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸° (ë” ì •í™•í•œ ë°©ë²•)
      const now = new Date();
      const today = now.getFullYear() + '-' +
          String(now.getMonth() + 1).padStart(2, '0') + '-' +
          String(now.getDate()).padStart(2, '0');

      const endDate = document.getElementById('end-date').value;
      console.log('â­ì •í™•í•œ ë‚ ì§œ ë¹„êµ:', endDate, today, endDate === today);

      if (endDate === today) {
        console.log('ğŸ”„ 10ì´ˆ ìë™ ì—…ë°ì´íŠ¸ ì„¤ì • ì„±ê³µ!!');
        // 10ì´ˆë§ˆë‹¤ ìë™ ì—…ë°ì´íŠ¸ ì„¤ì •
        customDateInterval = setInterval(fetchCustomDateData, 10000);
      }
    }
  });

  // ì›Œë“œí”„ë ˆìŠ¤ ì¹´í…Œê³ ë¦¬ ë™ê¸°í™” í•¨ìˆ˜ ì¶”ê°€ (ê°œì„  ë²„ì „)
  function syncWordPressCategories(forceFullSync = false) {
    const syncButton = document.querySelector('.sync-button');
    const fullSyncButton = document.querySelector('.full-sync-button');
    const originalText = syncButton.innerHTML;
    const originalFullSyncText = fullSyncButton.innerHTML;

    // ëª¨ë“  ë™ê¸°í™” ë°°ë„ˆë¥¼ í‘œì‹œí•©ë‹ˆë‹¤
    document.querySelectorAll('.sync-banner').forEach(banner => {
      banner.textContent = forceFullSync ?
          'â³ ì „ì²´ ì¹´í…Œê³ ë¦¬ ë™ê¸°í™” ì¤‘... ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë¦´ ìˆ˜ ìˆì–´ìš”!' :
          'â³ ì¹´í…Œê³ ë¦¬ ë™ê¸°í™” ì¤‘... ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!';
      banner.classList.add('visible');
    });

    // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½ ë° ë¹„í™œì„±í™”
    syncButton.innerHTML = '<span class="sync-button-icon">â³</span> ë™ê¸°í™” ì¤‘...';
    syncButton.disabled = true;
    fullSyncButton.innerHTML = '<span class="sync-button-icon">â³</span> ë™ê¸°í™” ì¤‘...';
    fullSyncButton.disabled = true;

    // API í˜¸ì¶œ URL ìˆ˜ì • (forceFullSync íŒŒë¼ë¯¸í„° ì¶”ê°€)
    fetch(`/api/sync-wordpress-categories${forceFullSync ? '?forceFullSync=true' : ''}`)
    .then(response => response.json())
    .then(data => {
      // ëª¨ë“  ë™ê¸°í™” ë°°ë„ˆ ì—…ë°ì´íŠ¸
      document.querySelectorAll('.sync-banner').forEach(banner => {
        banner.textContent = 'âœ… ë™ê¸°í™” ì™„ë£Œ! ì¹´í…Œê³ ë¦¬ ë°ì´í„°ê°€ ìµœì‹  ìƒíƒœì˜ˆìš”! ğŸ’';

        // 3ì´ˆ í›„ì— ë°°ë„ˆ ìˆ¨ê¸°ê¸°
        setTimeout(() => {
          banner.classList.remove('visible');
        }, 3000);
      });

      // ë™ê¸°í™” í›„ ë°ì´í„° ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸°
      fetchTodayData();
      fetchLast30MinData();

      // ë²„íŠ¼ ë³µì›
      syncButton.innerHTML = originalText;
      syncButton.disabled = false;
      fullSyncButton.innerHTML = originalFullSyncText;
      fullSyncButton.disabled = false;
    })
    .catch(error => {
      console.error('ì¹´í…Œê³ ë¦¬ ë™ê¸°í™” ì‹¤íŒ¨:', error);

      // ëª¨ë“  ë™ê¸°í™” ë°°ë„ˆ ì—…ë°ì´íŠ¸
      document.querySelectorAll('.sync-banner').forEach(banner => {
        banner.textContent = 'âŒ ë™ê¸°í™” ì‹¤íŒ¨! ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”! ğŸ˜¢';
      });

      // ë²„íŠ¼ ë³µì›
      syncButton.innerHTML = originalText;
      syncButton.disabled = false;
      fullSyncButton.innerHTML = originalFullSyncText;
      fullSyncButton.disabled = false;
    });
  }

</script>
</body>
</html>